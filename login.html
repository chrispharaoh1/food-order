<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>
  <!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500&family=Lora:wght@600;700&display=swap" rel="stylesheet"> 

  <!-- Icon Font Stylesheet -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Libraries Stylesheet -->
  <link href="lib/animate/animate.min.css" rel="stylesheet">
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/bootstrap.min.css" rel="stylesheet">

  <!-- Template Stylesheet -->
  <link href="css/style.css" rel="stylesheet">
  <style>
  /* Register form */
  /* Adjust the width of the captcha input */
  #captcha {
    width: 80%; /* Adjust as needed */
  }
  #captcha-image{
    border: 2px solid #555;
    height: 40%;
    background-image: url(img/captcha/backg.jpeg);
    margin-top: 25px;
  }
  .btn{
    width:50%;
    margin-left: auto;
    margin-right: auto;
    display: block;
    
  }
  #form{
    margin-top: 7%;
  }
  </style>
</head>
<body style="background-image: url(img/background.PNG);  background-repeat: repeat-x;">
  
    <!-- Navbar Start -->
    <div class="container-fluid fixed-top px-0 wow fadeIn" data-wow-delay="0.1s">
      <div class="top-bar row gx-0 align-items-center d-none d-lg-flex">
          <div class="col-lg-6 px-5 text-start">
              <small><i class="fa fa-map-marker-alt me-2"></i> Zone I, Islamabad, Pakistan</small>
              <small class="ms-4"><i class="fa fa-envelope me-2"></i>info@subhan.com</small>
          </div>
          <div class="col-lg-6 px-5 text-end">
              <small>Follow us:</small>
              <a class="text-body ms-3" href=""><i class="fab fa-facebook-f"></i></a>
              <a class="text-body ms-3" href=""><i class="fab fa-twitter"></i></a>
              <a class="text-body ms-3" href=""><i class="fab fa-linkedin-in"></i></a>
              <a class="text-body ms-3" href=""><i class="fab fa-instagram"></i></a>
          </div>
      </div>

      <nav class="navbar navbar-expand-lg navbar-light py-lg-0 px-lg-5 wow fadeIn" data-wow-delay="0.1s">
          <a href="index.html" class="navbar-brand ms-4 ms-lg-0">
            <img src="img/logo-re.png" alt="logo">
          </a>
          <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
              <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
              <div class="navbar-nav ms-auto p-4 p-lg-0">
                  <a href="index.html" class="nav-item nav-link active">Home</a>
                  <a href="about.html" class="nav-item nav-link">About Us</a>
                  <a href="product.html" class="nav-item nav-link">Products</a>
                  <a href="contact.html" class="nav-item nav-link">Contact Us</a>
                  <a href="login.html" class="nav-item nav-link">Login</a>
                  <a href="register.html" class="nav-item nav-link">SignUp</a>
                  <div class="nav-item dropdown">
          
                  </div>
                  
              </div>
              <div class="d-none d-lg-flex ms-2">
                          <a class="btn-sm-square bg-white rounded-circle ms-3" href="">
                      <small class="fa fa-shopping-bag text-body"></small>
                  </a>
              </div>
          </div>
      </nav>
  </div>
  <!-- Navbar End -->
<!-- Loggin form starts here-->
<div class="container" id="form">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card mt-5">
        <div class="card-header">
          Login
        </div>
        <div class="card-body">
          <form id="loginForm">
            <div class="form-group">
              <label for="email">Email address</label>
              <input type="email" class="form-control" id="email" aria-describedby="emailHelp" placeholder="Enter email" required>
            </div>
            <div class="form-group">
              <label for="password">Password</label>
              <input type="password" class="form-control" id="password" placeholder="Password" required>
            </div>
            <div class="form-group row">
              <div class="col-6">
                <label for="captcha">Captcha</label>
                <input type="text" class="form-control" id="captcha" placeholder="Enter captcha code" required>
              </div>
              <div class="col-6">
                <img id="captcha-image" src="" alt="Captcha Image" class="img-fluid ml-2">
              </div>
            </div>          
            <button type="submit" class="btn btn-primary">Login</button>
          </form>
          <!-- Error messages will be showing here -->
          <div id="message" class="mt-3" style="color:red;"></div>

          <!-- The modal to be showing when the user successfully logged in -->
          <div class="modal fade" id="loginSuccessModal" tabindex="-1" role="dialog" aria-labelledby="loginSuccessModalLabel" aria-hidden="true">        
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="loginSuccessModalLabel">Success</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <h5 style="text-align: center;">You have successfully logged in!</h5>
                  <p style="text-align: center;">We're redirecting you...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


    <!-- Footer Start -->
    <div class="container-fluid bg-dark footer mt-5 pt-5 wow fadeIn" data-wow-delay="0.1s">
      <div class="container py-5">
          <div class="row g-5">
              <div class="col-lg-3 col-md-6">
                  <h1 class="fw-bold text-primary mb-4">SUBHAN</h1>
                  <p>Savor the essence of culinary delight at Subhan Food Store â€“ where every bite is a symphony of flavor!</p>
                  <div class="d-flex pt-2">
                      <a class="btn btn-square btn-outline-light rounded-circle me-1" href=""><i class="fab fa-twitter"></i></a>
                      <a class="btn btn-square btn-outline-light rounded-circle me-1" href=""><i class="fab fa-facebook-f"></i></a>
                      <a class="btn btn-square btn-outline-light rounded-circle me-1" href=""><i class="fab fa-youtube"></i></a>
                      <a class="btn btn-square btn-outline-light rounded-circle me-0" href=""><i class="fab fa-linkedin-in"></i></a>
                  </div>
              </div>
              <div class="col-lg-3 col-md-6">
                  <h4 class="text-light mb-4">Address</h4>
                  <p><i class="fa fa-map-marker-alt me-3"></i>Zone I, Islamabad, Pakistan</p>
                  <p><i class="fa fa-phone-alt me-3"></i>+92 255 355</p>
                  <p><i class="fa fa-envelope me-3"></i>info@subhan.com</p>
              </div>
              <div class="col-lg-3 col-md-6">
                  <h4 class="text-light mb-4">Quick Links</h4>
                  <a class="btn btn-link" href="">About Us</a>
                  <a class="btn btn-link" href="">Contact Us</a>
                  <a class="btn btn-link" href="">Our Services</a>
                  <a class="btn btn-link" href="">Terms & Condition</a>
                  <a class="btn btn-link" href="">Support</a>
              </div>
              <div class="col-lg-3 col-md-6">
                  <h4 class="text-light mb-4">Newsletter</h4>
                  <p>Subbscribe to our Newsletter</p>
                  <div class="position-relative mx-auto" style="max-width: 400px;">
                      <input class="form-control bg-transparent w-100 py-3 ps-4 pe-5" type="text" placeholder="Your email">
                      <button type="button" class="btn btn-primary py-2 position-absolute top-0 end-0 mt-2 me-2">SignUp</button>
                  </div>
              </div>
          </div>
      </div>
      <div class="container-fluid copyright">
          <div class="container">
              <div class="row">
                  <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                      &copy; <a href="#">subhan.com</a>, All Right Reserved.
                  </div>

              </div>
          </div>
      </div>
  </div>
  <!-- Footer End -->

<!-- Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Two-dimensional array of captcha image paths and corresponding values
    var captchaImages = [
      ["img/captcha/rec.png", "AeiR2"],
      ["img/captcha/rec1.png", "24qU3"],
      ["img/captcha/rec2.png", "ecb4f"],
      ["img/captcha/rec3.jpeg", "7pLBj8"]
      
    ];

    // Get the captcha image and input elements
    var captchaImage = document.getElementById("captcha-image");
    var captchaInput = document.getElementById("captcha");

    // Function to set a random captcha image and its value
    function setRandomCaptchaImage() {
      var randomIndex = Math.floor(Math.random() * captchaImages.length);
      var randomCaptcha = captchaImages[randomIndex];
      captchaImage.src = randomCaptcha[0]; // Set image source
      captchaInput.value = ""; // Clear previous input value
      localStorage.setItem("captchaValue", randomCaptcha[1]); // Store value in localStorage
    }

    // Initial call to set a random captcha image and value
    setRandomCaptchaImage();

    // Event listener to change captcha image and value on click
    captchaImage.addEventListener("click", function() {
      setRandomCaptchaImage();
    });
  });
</script>



<script>
  // Load captcha image on page load
window.onload = function() {
  var captchaValue = localStorage.getItem('captchaValue');
  // document.getElementById('captcha-image').src = 'captcha.php?captchaValue=' + captchaValue;
}

// Handle form submission
document.getElementById('loginForm').addEventListener('submit', function(event) {
  event.preventDefault();

  var email = document.getElementById('email').value;
  var password = document.getElementById('password').value;
  var captcha = document.getElementById('captcha').value;
  var captchaValue = localStorage.getItem('captchaValue');

  if (captcha !== captchaValue) {
    showMessage('Incorrect captcha, click the image to change');
    return;
  }

  var xhr = new XMLHttpRequest();
  xhr.open('POST', 'login.php', true);
  xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
  xhr.onreadystatechange = function() {
    if (xhr.readyState === XMLHttpRequest.DONE) {
      if (xhr.status === 200) {
        var response = JSON.parse(xhr.responseText);
        showMessage(response.message);


        
        // the success message is empty- so if the message is empty show modal and redirect after 3 seconds
        if(response.message == ""){
            var loginSuccessModal = new bootstrap.Modal(document.getElementById('loginSuccessModal'));
            loginSuccessModal.show();

            // Redirect after 3 seconds
            setTimeout(function() {
               window.location.href = 'customer/customer.html';
            }, 5000);
        }


      } else {
        showMessage('An error occurred. Please try again later.');
      }
    }
  };
  xhr.send('email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(password));
});

// Function to display messages
function showMessage(message) {
  document.getElementById('message').innerHTML = '<p>' + message + '</p>';
}

</script>

 <!-- JavaScript Libraries -->
 <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
 <script src="lib/wow/wow.min.js"></script>
 <script src="lib/easing/easing.min.js"></script>
 <script src="lib/waypoints/waypoints.min.js"></script>
 <script src="lib/owlcarousel/owl.carousel.min.js"></script>
<script src="js/main.js"></script>
</body>
</html>
